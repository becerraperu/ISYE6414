---
title: "HW3"
author: "Chong Zhang"
date: "September 26, 2018"
output: html_document
---

###Load data
```{r warning=FALSE, message=FALSE}
library(ggplot2)
library(gridExtra)
data_table = read.table('Birthweight.csv', header = T, sep = ',')
head(data_table)
```
###Question 1: Exploratory Data Analysis.
####**a**. Using a scatterplot describe the relationship between BirthWt and the numeric independent variables; Age, MotherWt, NumPreLabor, NumPhysicianVt. Describe the general trend (direction and form). What are the values of the correlation coefficients? Please interpret.

```{r }
p1 = ggplot(data = data_table, aes(x=BirthWt, y = Age))+geom_point(shape=1)+geom_smooth(method = 'lm')+xlab('Birth Weight')+ylab('Age of mother')+theme(axis.title = element_text(size=12))
p2 = ggplot(data = data_table, aes(x=BirthWt, y = MotherWt))+geom_point(shape=1)+geom_smooth(method = 'lm')+xlab('Birth Weight')+ylab('Weight of mother')+theme(axis.title = element_text(size=12))
p3 = ggplot(data = data_table, aes(x=BirthWt, y = NumPreLabor))+geom_point(shape=1)+geom_smooth(method = 'lm')+xlab('Birth Weight')+ylab('Number of pre-labor')+theme(axis.title = element_text(size=12))
p4 = ggplot(data = data_table, aes(x=BirthWt, y = NumPhysicianVt))+geom_point(shape=1)+geom_smooth(method = 'lm')+xlab('Birth Weight')+ylab('Number of Physician Visit')+theme(axis.title = element_text(size=12))
grid.arrange(p1,p2,p3,p4)

round(cor(data_table[c(1,2,3,6,9)]),2)

Cor_co1 = round(cor(data_table$BirthWt, data_table$Age),2)
Cor_co2 = round(cor(data_table$BirthWt, data_table$MotherWt),2)
Cor_co3 = round(cor(data_table$BirthWt, data_table$NumPreLabor),2)
Cor_co4 = round(cor(data_table$BirthWt, data_table$NumPhysicianVt),2)
```
#####It seems that there is **no** linear relationship between the birth weight and the age of the monther. The distibution of birth weight is similar across all ages.  The correlation coefficient of this pair of data is **```r Cor_co1```**. It means that there is no linear relationship.

#####It seems that there is a **very very mild** linear relationship between the birth weight and the weight of the monther. It seems that the heavier the mother, the heavier of the baby. The correlation coefficient of this pair of data is **```r Cor_co2```**. It indicates a very very mild linear relationship.

#####It seems that there is **no** linear relationship between the birth weight and the weight of the monther. The correlation coefficient of this pair of data is **```r Cor_co3```**. It suggests that there is no linear relationship.

#####It seems that there is **no** linear relationship between the birth weight and the weight of the monther. The correlation coefficient of this pair of data is **```r Cor_co4```**. It suggest that there is no linear relationship.


####**b**. Describe the relationship between BirthWt and the categorical independent variables Race, Smoke, Hypertension, UterineIrr. Does BirthWt vary with the categorical variables? Use boxplot function in R as follows:
```{r }
par(mfrow=c(2,2))
boxplot(data_table$BirthWt~as.factor(data_table$Race),xlab="Race", ylab='BirthWeight')
boxplot(data_table$BirthWt~as.factor(data_table$Smoke), xlab="Smoke", ylab="BirthWt")
boxplot(data_table$BirthWt~as.factor(data_table$Hypertension), xlab="Hypertension", ylab="BirthWt")
boxplot(data_table$BirthWt~as.factor(data_table$UterineIrr), xlab="Uterine Irritability", ylab="BirthWt")

```

##### For the variable **Race**, it seems that mothers with the race of **White** gave birth to babies with higher brith weight. For the variable **Smoke**, it seems that the mothers who **smoke** gave birth to babies with lower brith weight. For the variable **Hypertension**, it seems that the mothers with **Hypertension** gave birth to babies with lower brith weight. For the variable **Uterine Irritability**, it seems that the mothers with **Uterine Irritability** gave birth to babies with lower brith weight. 


####**c**. Based on this exploratory analysis, is it reasonable to assume a linear regression model? Would you suggest that BirthWt varies with all or only some of the independent variables? Would you recommend using the qualitative variables Race, Smoke, Hypertension, UterineIrr in the model? Why?
```{r warning=FALSE}
summary(aov(lm(data_table$BirthWt~data_table$Race)))
summary(aov(lm(data_table$BirthWt~data_table$Smoke)))
summary(aov(lm(data_table$BirthWt~data_table$Hypertension)))
summary(aov(lm(data_table$BirthWt~data_table$UterineIrr)))
```
#####Based on the exploratory analysis above, I think it is reasonable to assume a linear regression model. The reponse variable BirthWt only varies with limited number of independent variables, such as MotherWt. I would use the all the qualitative variables. Because ANOVA test suggests that the means of response variable are statistically different with respect to the qualitative variable.

####Question 2: Fitting the Linear Regression Model.
Fit a linear regression to evaluate the relationship between BirthWt and all the predictors.
```{r}
model = lm(data_table$BirthWt~., data=data_table)
summary(model)
coef = round(model$coefficients,2)
```

####(i) What are the model parameters and what are their estimates?
There are **10** model parameters as shown above. The estimates of those parameters are also shown above.

####(ii) Write down the equation for the regression line;
$BirthWt = 2439.53-3.57*Age+4.35*MotherWt+133.35*RaceOther+488.43RaceWhite-352.04{*}SmokeYes-48.40*NumPreLabor-592.83*HypertensionYes-516.08*UterineIrrYes-14.06*NumPhysicianVt$

####(iii) Interpret the estimated value of the parameters corresponding with Age, MotherWt and Race in the context of the problem.
##### For the parameter corresponding to **Age**, it means that with one year increase in the age of the mother, there will be **3.57 gram decrease** in the Birth weight of the baby when holding all other variables constant.
##### For the parameter corresponding to **MotherWt**, it means that with one pound increase in the weight of mother, there will be **4.35 gram increase** in the Birth weight of the baby when holding all other variables constant.
##### For the parameter of Race, the regression model used **Black** as its baseline, so for **RaceOther**, it means that when the monther's race is **Other**, there will be a **133.35 gram increase** in the Birth weight of the baby compared to the Birth weight of a baby whose mother is **Black** when holding all other variables contant.
#####Similarly, for **RaceWhite**, it means that when the monther's race is **White**, there will be a **488.43 gram increase** in the Birth weight of the baby compared to the Birth weight of a baby whose mother is **Black** when holding all other variables contant.